<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.admin.admin.dao.dw_location.LocationDao">

    <select id="listLocationModel" parameterType="String"  resultType="com.admin.model.location.LocationModel">
        SELECT t.suspectstatus,t.personid,t.personname,t.age,t.gender,t.address,t.policestation,t.sponsor,t.casetype,E.areaname,t.bailoutbegindate AS Starttime
        FROM "t_personinformation" As t
        INNER JOIN t_enclosure AS E on T.personid=E.personid
        <if test="condition!=null and condition!=''">
            <where>
                t.suspectstatus like concat('%',#{condition},'%') or
                t.personname like concat('%',#{condition},'%') or
                t.gender like concat('%',#{condition},'%') or
                t.address like concat('%',#{condition},'%') or
                t.policestation like concat('%',#{condition},'%') or
                t.casetype like concat('%',#{condition},'%') or
                t.sponsor like concat('%',#{condition},'%') or
                E.areaname like concat('%',#{condition},'%')
            </where>
        </if>
    </select>

    <select id="ListLocation" parameterType="String" resultType="com.admin.admin.entity.dw_location.Locationmation">
         SELECT * from t_location
         where personid=#{PersonId}
         <if test="date !=null and date !=''">
         and to_char(timestamp,'yyyy-mm-dd')  like concat('%',#{date},'%')
         </if>
    </select>

  <select id="HistoricalTrack" parameterType="com.admin.model.Execl.ExeclModel" resultType="com.admin.admin.entity.dw_location.Locationmation">
           SELECT * from t_location
         where personid = #{PersonId}
         <if test="list.size()>0">
         and id in
             <foreach collection="list" item="id" index="index" open="(" close=")" separator=",">
                 #{id}
             </foreach>
         </if>
    </select>

    <select id="GetLocation" parameterType="int" resultType="com.admin.admin.entity.dw_location.Locationmation">
        select * from t_location where id=#{id}
    </select>
<!--这个 这个我是想查那个人离当前日期最近的一条记录 那个是数据库函数 获得当前时间 稍等，处理一下线上 噢噢  这个是数据查的不准确..-->
    <select id="GetLocationByPerson" parameterType="String" resultType="com.admin.admin.entity.dw_location.Locationmation">
        SELECT * FROM t_location
        where personid=#{PersonId} AND timestamp &lt; now()
        order by timestamp desc limit 1
    </select>



</mapper>