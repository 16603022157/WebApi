<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.admin.admin.dao.dw_log.LogDao">
    <insert id="insertLog" parameterType="com.admin.admin.entity.dw_log.LogInformation">
        insert into t_log(operator, modular, action, operatingtime) values (#{operator},#{modular},#{action},#{operatingtime})
    </insert>

    <select id="listLog" parameterType="com.admin.model.log.LogParamModel"
            resultType="com.admin.model.log.LogReturnModel">
        select u.accountname as operator,l.modular,l.action,l.operatingtime  from t_log as l
        inner join t_user as u on u.id=l.operator
        where u.accountname=#{operator} and modular=#{modular}
    </select>

    <select id="listAllLog" parameterType="com.admin.model.log.LogSearchModel" resultType="com.admin.model.log.LogModel">
        select id,operator,modular,action,operatingtime from t_log
        <if test="date.operator!=null">
            where operator=#{date.operator}
        </if>
        <if test="date.operator!=null and date.modular!=null">
            and modular like concat('%',#{date.modular},'%')
        </if>
        <if test="date.operator==null and date.modular!=null">
            where modular like concat('%',#{date.modular},'%')
        </if>
        <if test="(date.operator!=null or date.modular!=null)and date.startTime!=null">
            and operatingTime &lt;= #{date.startTime}
        </if>
        <if test="date.operator==null and date.modular==null and date.startTime!=null">
            where operatingTime &lt;= #{date.startTime}
        </if>
        <if test="(date.operator!=null or date.modular!=null or date.startTime!=null)and date.endTime!=null">
            and operatingTime >#{date.endTime}
        </if>
        <if test="date.operator==null and date.modular==null and date.startTime!=null and date.endTime!=null">
            where operatingTime >#{date.endTime}
        </if>
    </select>

    <delete id="deleteLog">
        delete from t_log where id=#{id}
    </delete>
</mapper>